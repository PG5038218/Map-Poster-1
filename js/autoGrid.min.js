/* ======================================================= 
 * Auto Grid Responsive Gallery
 * By David Blanco
 *
 * Contact: http://codecanyon.net/user/davidbo90
 *
 * Created: June 6, 2013
 *
 * Copyright (c) 2013, David Blanco. All rights reserved.
 * Released under CodeCanyon License http://codecanyon.net/
 *
 * Note: Script based in jQuery Masonry v2.1.07 made by David DeSandro http://masonry.desandro.com/ (under MIT)
 *
 * ======================================================= */

!function(t,i){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",i):"object"==typeof module&&module.exports?module.exports=i():t.EvEmitter=i()}(this,function(){function t(){}var i=t.prototype;return i.on=function(t,i){if(t&&i){var e=this._events=this._events||{},o=e[t]=e[t]||[];return-1==o.indexOf(i)&&o.push(i),this}},i.once=function(t,i){if(t&&i){this.on(t,i);var e=this._onceEvents=this._onceEvents||{},o=e[t]=e[t]||[];return o[i]=!0,this}},i.off=function(t,i){var e=this._events&&this._events[t];if(e&&e.length){var o=e.indexOf(i);return-1!=o&&e.splice(o,1),this}},i.emitEvent=function(t,i){var e=this._events&&this._events[t];if(e&&e.length){var o=0,s=e[o];i=i||[];for(var n=this._onceEvents&&this._onceEvents[t];s;){var r=n&&n[s];r&&(this.off(t,s),delete n[s]),s.apply(this,i),o+=r?0:1,s=e[o]}return this}},t}),function(t,i){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(e){return i(t,e)}):"object"==typeof module&&module.exports?module.exports=i(t,require("ev-emitter")):t.imagesLoaded=i(t,t.EvEmitter)}(window,function(t,i){function e(t,i){for(var e in i)t[e]=i[e];return t}function o(t){var i=[];if(Array.isArray(t))i=t;else if("number"==typeof t.length)for(var e=0;e<t.length;e++)i.push(t[e]);else i.push(t);return i}function s(t,i,n){return this instanceof s?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=o(t),this.options=e({},this.options),"function"==typeof i?n=i:e(this.options,i),n&&this.on("always",n),this.getImages(),a&&(this.jqDeferred=new a.Deferred),void setTimeout(function(){this.check()}.bind(this))):new s(t,i,n)}function n(t){this.img=t}function r(t,i){this.url=t,this.element=i,this.img=new Image}var a=t.jQuery,l=t.console;s.prototype=Object.create(i.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var i=t.nodeType;if(i&&h[i]){for(var e=t.querySelectorAll("img"),o=0;o<e.length;o++){var s=e[o];this.addImage(s)}if("string"==typeof this.options.background){var n=t.querySelectorAll(this.options.background);for(o=0;o<n.length;o++){var r=n[o];this.addElementBackgroundImages(r)}}}};var h={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var i=getComputedStyle(t);if(i)for(var e=/url\((['"])?(.*?)\1\)/gi,o=e.exec(i.backgroundImage);null!==o;){var s=o&&o[2];s&&this.addBackground(s,t),o=e.exec(i.backgroundImage)}},s.prototype.addImage=function(t){var i=new n(t);this.images.push(i)},s.prototype.addBackground=function(t,i){var e=new r(t,i);this.images.push(e)},s.prototype.check=function(){function t(t,e,o){setTimeout(function(){i.progress(t,e,o)})}var i=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(i){i.once("progress",t),i.check()}):void this.complete()},s.prototype.progress=function(t,i,e){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,i]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+e,t,i)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var i=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[i](this)}},n.prototype=Object.create(i.prototype),n.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},n.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},n.prototype.confirm=function(t,i){this.isLoaded=t,this.emitEvent("progress",[this,this.img,i])},n.prototype.handleEvent=function(t){var i="on"+t.type;this[i]&&this[i](t)},n.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},n.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},n.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(n.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(t,i){this.isLoaded=t,this.emitEvent("progress",[this,this.element,i])},s.makeJQueryPlugin=function(i){i=i||t.jQuery,i&&(a=i,a.fn.imagesLoaded=function(t,i){var e=new s(this,t,i);return e.jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s}),function(t,i,e){"use strict";var o,s=i.event,n=i.event.handle?"handle":"dispatch";s.special.smartresize={setup:function(){i(this).bind("resize",s.special.smartresize.handler)},teardown:function(){i(this).unbind("resize",s.special.smartresize.handler)},handler:function(t,i){var e=this,r=arguments;t.type="smartresize",o&&clearTimeout(o),o=setTimeout(function(){s[n].apply(e,r)},"execAsap"===i?0:100)}},i.fn.smartresize=function(t){return t?this.bind("smartresize",t):this.trigger("smartresize",["execAsap"])},i.Mason=function(t,e){this.element=i(e),this._create(t),this._init()},i.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500,complete:function(){var t=i(this);t.hasClass("grid-brick")||(i.fn.grid.defaults.lazyLoad&&i.waypoints("refresh"),t.hasClass("grid-with-loading-boxes")&&(t.removeClass("grid-with-loading-boxes"),t.addClass("completeAddingImages")))}},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},i.Mason.prototype={_resized:!1,_filterFindBricks:function(t){var i=this.options.itemSelector;return i?t.filter(i).add(t.find(i)):t},_getBricks:function(t){var i=this._filterFindBricks(t).css({position:"absolute"}).addClass("grid-brick");return i},_create:function(e){this.options=i.extend(!0,{},i.Mason.settings,e),this.styleQueue=[];var o=this.element[0].style;this.originalStyle={height:o.height||""};var s=this.options.containerStyle;for(var n in s)this.originalStyle[n]=o[n]||"";this.element.css(s),this.horizontalDirection=this.options.isRTL?"right":"left";var r=this.element.css("padding-"+this.horizontalDirection),a=this.element.css("padding-top");this.offset={x:r?parseInt(r,10):0,y:a?parseInt(a,10):0},this.isFluid=this.options.columnWidth&&"function"==typeof this.options.columnWidth;var l=this;setTimeout(function(){l.element.addClass("grid")},0),this.options.isResizable&&i(t).bind("smartresize.grid",function(){l.resize()}),this.reloadItems()},_init:function(t){this._getColumns(),this._reLayout(t)},option:function(t,e){i.isPlainObject(t)&&(this.options=i.extend(!0,this.options,t))},layout:function(t,i){for(var e=0,o=t.length;o>e;e++)this._placeBrick(t[e]);var s={};if(s.height=Math.max.apply(Math,this.colYs),this.options.isFitWidth){var n=0;for(e=this.cols;--e&&0===this.colYs[e];)n++;s.width=(this.cols-n)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:s});var r,a=this.isLaidOut&&this.options.isAnimated?"animate":"css",l=this.options.animationOptions,h=!1;for(e=0,o=this.styleQueue.length;o>e;e++){r=this.styleQueue[e],a=this.isLaidOut&&this.options.isAnimated?"animate":"css";var d=r.$el.hasClass("loading-box");d&&!this.element.hasClass("noSupportTransform")?(a="css",h=!0):h&&r.$el.css(r.style,l),r.$el.removeClass("loading-box");var c=r.$el.css("left"),u=r.$el.css("top"),f=r.style.left+"px",g=r.style.top+"px";c==f&&u==g||1==d?r.$el.data("moving",!1):r.$el.data("moving",!0);r.$el[a](r.style,l)}this.styleQueue=[],i&&i.call(t),this.isLaidOut=!0},_getColumns:function(){var t=this.options.isFitWidth?this.element.parent():this.element,i=t.width();this.columnWidth=this.isFluid?this.options.columnWidth(i):this.options.columnWidth||this.$bricks.outerWidth(!0)||i,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((i+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(t){var e,o,s,n,r,a=i(t);if(e=Math.ceil(a.outerWidth(!0)/this.columnWidth),e=Math.min(e,this.cols),1===e)s=this.colYs;else for(o=this.cols+1-e,s=[],r=0;o>r;r++)n=this.colYs.slice(r,r+e),s[r]=Math.max.apply(Math,n);for(var l=Math.min.apply(Math,s),h=0,d=0,c=s.length;c>d;d++)if(s[d]===l){h=d;break}var u={top:l+this.offset.y};u[this.horizontalDirection]=this.columnWidth*h+this.offset.x,this.styleQueue.push({$el:a,style:u});var f=l+a.outerHeight(!0),g=this.cols+1-c;for(d=0;g>d;d++)this.colYs[h+d]=f},resize:function(){var t=this.cols;this._getColumns(),(this.isFluid||this.cols!==t)&&this._reLayout()},_reLayout:function(t){var i=this.cols;for(this.colYs=[];i--;)this.colYs.push(0);this.layout(this.$bricks,t)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(t){this.reloadItems(),this._init(t)},appended:function(t,i,e){if(i){this._filterFindBricks(t).css({top:this.element.height()});var o=this;setTimeout(function(){o._appended(t,e)},1)}else this._appended(t,e)},_appended:function(t,i){var e=this._getBricks(t);this.$bricks=this.$bricks.add(e),this.layout(e,i)},remove:function(t){this.$bricks=this.$bricks.not(t),t.remove()},destroy:function(){this.$bricks.removeClass("grid-brick").each(function(){this.style.position="",this.style.top="",this.style.left=""});var e=this.element[0].style;for(var o in this.originalStyle)e[o]=this.originalStyle[o];this.element.unbind(".grid").removeClass("grid").removeData("grid"),i(t).unbind(".grid")}},i.fn.grid=function(o){var s=function(s){var n=i.extend({},i.fn.grid.defaults,o);n.visibleCaption&&(n.caption=!1),o!=e&&o.lazyLoad!=e&&(i.fn.grid.defaults.lazyLoad=o.lazyLoad),o==e&&(o={}),o.isFitWidth=n.isFitWidth,o.isAnimated=n.isAnimated,o.itemSelector=".gbox",o.gutterWidth=n.horizontalSpaceBetweenThumbnails;var r=i(s).addClass("centered").addClass("grid-clearfix"),a=n.columnWidth;"auto"==a?o.columnWidth=function(t){for(var i=-999,e=n.columns;e>=1;e--)i<n.columnMinWidth&&(i=(t-(e-1)*o.gutterWidth)/e|0);return r.find("div.gbox").width(i),i}:"function"!=typeof a&&(o.columnWidth=function(t){var i=a;return r.find("div.gbox").width(i),i}),r.find("div.gbox").css("margin-bottom",n.verticalSpaceBetweenThumbnails);var l=function(){var t=document.createElement("div"),i="Khtml ms O Moz Webkit".split(" "),e=i.length;return function(o){if(o in t.style)return!0;for(o=o.replace(/^[a-z]/,function(t){return t.toUpperCase()});e--;)if(i[e]+o in t.style)return!0;return!1}}();l("transform")?r.addClass("visible"):r.addClass("noSupportTransform");var h=null,d=r.data("directory"),c=i('<ul class="category-navbar" />').hide().insertBefore(r),u=function(){var t=c.find("li[class=select]").attr("category");return t},f=i("<div />").insertAfter(r),g=function(){f.addClass("grid-loader").removeClass("grid-loadMore").html("")},m=function(){f.removeClass("grid-loader")},p=!1,v=function(t){var i=0;for(var e in h){var o=h[e];if(t==e||"all"==t)for(var s in o)i++}return i>0?(p=!1,!0):!1},y=function(t){t?f.addClass("grid-loadMore").html("LOAD MORE IMAGES"):f.removeClass("grid-loadMore").html("")},b=function(t,i,e){var o="thumbnails/";"no"==e&&(o="");var s=t+"/";"all"==t&&(s="");var r=i.split(/\.(?=[^.]*$)/)[0],a=t;"-"==a.substr(1,1)&&(a=a.substr(2));var l="<h5>In "+a+"</h5>";("all"==t||0==n.captionCategory)&&(l="");var h="";if(-1!=r.indexOf("$$")){var c=r.split("$$");r=c[0];var u=c[1].split(":").join("/");u=u.split("|").join("/"),h='data-url="'+u+'"'}"-"==r.substr(1,1)&&(r=r.substr(2));var f="";n.visibleCaption&&(f="visible-caption");var g='<div class="gbox" data-category="'+t+'" '+h+'><img alt="'+r+'" title="'+r+'" src="'+d+"/"+s+o+i+'" data-lightbox="'+d+"/"+s+i+'" /><div class="image-caption '+f+'"><h3>'+r+"</h3>"+l+'</div><div class="lightbox-text">'+r+" <span>In "+a+'</span></div><div class="lightbox-img-title" style="display:none;">'+r+"</div></div>";return g},x=function(){var t=u();"all"!=t&&r.children("div").not('.gbox[data-category="'+t+'"]').removeClass("gbox grid-brick").hide()},C=function(t){t=i(t).addClass("loading-box"),t.css("margin-bottom",n.verticalSpaceBetweenThumbnails),r.append(t.hide()),r.imagesLoaded(function(){t.hide(),x(),r.addClass("grid-with-loading-boxes"),r.grid("reload");var i=[];i.push(t),S(i,[]),m(),y(v(u())),p=!1})},k=function(t){var i=[],e=Array();for(var o in t)t.hasOwnProperty(o)&&i.push(t[o].order.toLowerCase()+"-&$&$-"+o);return i.sort(),"byName"==n.imagesOrder||"byDateReverse"==n.imagesOrder||i.reverse(),jQuery.each(i,function(i,o){var s=o.split("-&$&$-");s=s[1],e.push(t[s])}),e},w=function(t){g();var i=0;for(var e in h){var o=h[e],s=0;for(var r in o)s++;s>i&&(i=s)}var a=new Array;if(n.aleatoryImagesFromCategories)for(var l=0;i>l;l++){var d=0;for(var e in h){o=h[e];var c=e;0==d&&(c="all");var u=0;for(var r in o){if(u==l){a.push({category:c,image:r,thumb:o[r].thumb,order:o[r].order,categoryOriginal:e});break}u++}d++}}else{var d=0;for(var e in h){var o=h[e],c=e;0==d&&(c="all");for(var r in o)a.push({category:c,image:r,thumb:o[r].thumb,order:o[r].order,categoryOriginal:e});d++}}n.orderInAll&&"random"!=n.imagesOrder&&(a=k(a));for(var f="",m=0;t>m&&!(m>=a.length);){var p=a[m];f+=b(p.category,p.image,p.thumb),delete h[p.categoryOriginal][p.image],m++}C(f)},I=function(t,i){g();var e=new Array,o=0;for(var s in h){var r=h[s],a=s;if(0==o&&(a="all"),a==i)for(var l in r)e.push({category:a,image:l,thumb:r[l].thumb,order:r[l].order,categoryOriginal:s});o++}n.orderInAll&&"random"!=n.imagesOrder&&(e=k(e));for(var d="",c=0;t>c&&!(c>=e.length);){var u=e[c];d+=b(u.category,u.image,u.thumb),delete h[u.categoryOriginal][u.image],c++}C(d)},B=function(){if(f.hasClass("grid-loadMore")){var t=u();"all"==t?w(n.imagesToLoad):I(n.imagesToLoad,t)}};f.on("click",function(){B()}),n.lazyLoad&&f.waypoint(function(t){var i=r;i.hasClass("completeAddingImages")&&f.hasClass("grid-loadMore")&&(B(),i.removeClass("completeAddingImages"))},{context:t,continuous:!0,enabled:!0,horizontal:!1,offset:"bottom-in-view",triggerOnce:!1});var T=function(){var t=0;for(var e in h){var o=e;"-"==o.substr(1,1)&&(o=o.substr(2));var s=i("<li />").attr("category",e).appendTo(c);i("<a />").html(o).appendTo(s),0==t&&(s.addClass("select"),s.attr("category","all")),t++}n.smartNavBar&&2>=t&&(n.showNavBar=!1),n.showNavBar&&c.slideDown(400)},S=function(t,e){for(var s=0;s<t.length;s++)t[s].each(function(){var t=i(this).removeClass("noTransform");t.hasClass("grid-brick")&&(t.is(":hidden")?r.hasClass("noSupportTransform")?t.show():(t.show(),0==t.data("moving")?(t.animate(n.hiddenStyle,0),t.animate(n.visibleStyle,400,function(){t.addClass("noTransform")})):(t.animate(n.visibleStyle,0),t.addClass("noTransform"))):t.animate(n.visibleStyle,o.animOpts,function(){t.addClass("noTransform")}))});for(var s=0;s<e.length;s++)e[s].each(function(){var t=i(this).removeClass("noTransform");0==t.is(":hidden")&&(t.addClass("box"),r.hasClass("noSupportTransform")?(t.hide(),t.removeClass("box")):(t.animate(n.visibleStyle,0),t.animate(n.hiddenStyle,o.animOpts,function(){t.hide(),t.removeClass("box")})))})};i.getJSON("reader.php?directory="+d+"&categoriesOrder="+n.categoriesOrder+"&imagesOrder="+n.imagesOrder,function(t){h=t,jQuery.isArray(t.All)&&(t.All={}),c.css("display","none"),T(),w(n.imagesToLoadStart)}),c.on("click","a",function(t){t.preventDefault();var i=jQuery(this);if(!i.parent("li").hasClass("select")){r.removeClass("completeAddingImages"),r.addClass("grid-with-loading-boxes"),i.parent("li").addClass("select").siblings("li").removeClass("select");var o=r,s=i.parent("li").attr("category"),n=[],a=[];if("all"==s){var l=o.children("div").addClass("gbox grid-brick");r.hasClass("noSupportTransform")&&l.css({top:200,left:200}),n.push(l)}else{var h=o.children('div[data-category="'+s+'"]').addClass("gbox grid-brick");h[0]!=e&&(r.hasClass("noSupportTransform")&&h.css({top:200,left:200}),n.push(h.stop()));var d=o.children("div").not('.gbox[data-category="'+s+'"]').removeClass("gbox grid-brick");a.push(d)}r.grid("reload"),S(n,a),y(v(u()))}}),r.on("mouseenter.hoverdir, mouseleave.hoverdir","div.gbox",function(t){if(n.caption){var o=i(this),s=t.type,r=o.find("div.image-caption"),a=E(o,{x:t.pageX,y:t.pageY}),l=O(a,o),h=r.children("div.aligment");if(h[0]==e){var d=r.html();r.html("<div class='aligment'><div class='aligment'>"+d+"</div></div>")}if("mouseenter"===s){if("classic"==n.captionType)return r.css({left:0,top:0}),void r.fadeIn(300);r.css({left:l.from,top:l.to}),r.stop().show().fadeTo(0,1,function(){i(this).stop().animate({top:0,left:0},200,"linear")})}else{if("classic"==n.captionType)return r.css({left:0,top:0}),void r.fadeOut(300);"grid-fade"==n.captionType?r.fadeOut(700):r.stop().animate({left:l.from,top:l.to},200,"linear",function(){r.hide()})}}});var E=function(t,i){var e=t.width(),o=t.height(),s=(i.x-t.offset().left-e/2)*(e>o?o/e:1),n=(i.y-t.offset().top-o/2)*(o>e?e/o:1),r=Math.round((Math.atan2(n,s)*(180/Math.PI)+180)/90+3)%4;return r},O=function(t,i){var e,o;switch(t){case 0:n.reverse?(e=0,o=-i.height()):(e=0,o=-i.height());break;case 1:n.reverse?(e=-i.width(),o=0):(e=i.width(),o=0);break;case 2:n.reverse?(e=0,o=-i.height()):(e=0,o=i.height());break;case 3:n.reverse?(e=i.width(),o=0):(e=-i.width(),o=0)}return{from:e,to:o}},L=i("body"),A={interval:"none"},W=0,_=i('<div class="autoGrid-lightbox" />').appendTo(L),z=i('<div class="autoGrid-nav" />').appendTo(_),M=i('<div class="autoGrid-close" />').appendTo(z),$=(i('<i class="iconClose" />').appendTo(M),i('<div class="autoGrid-play" />'));n.lightboxPlayBtn&&$.appendTo(z);var F=(i('<i class="iconPlay" />').appendTo($),i('<div class="autoGrid-lbcaption" />').appendTo(z).html("Here will go the text for the lightbox")),j=i('<div class="autoGrid-next" />').appendTo(z),q=(i('<i class="iconNext" />').appendTo(j),i('<div class="autoGrid-prev" />').appendTo(z)),P=(i('<i class="iconPrev" />').appendTo(q),i('<div class="lightbox-timer" />').appendTo(_)),D=M.width(),Q=3;n.lightboxPlayBtn&&(Q=4);var N=function(){var t=_.outerWidth(!1);650>t?(F.hide(),j.css("width",t/Q),q.css("width",t/Q),$.css("width",t/Q),M.css("width",t-t/Q*(Q-1))):(F.show(),j.css("width",D),q.css("width",D),$.css("width",D),M.css("width",D));var i=_.find("img"),e=_.outerHeight(!1)-z.outerHeight(!1);i.css("max-height",e);var o=_.find("iframe"),e=_.outerHeight(!1)-z.outerHeight(!1);0!=e?o.css("max-height",e):o.css("max-height","none")};jQuery(t).resize(function(){N()});var G=new Image,H=function(){null!=G&&(G.onload=null,G=null),_.find(".lightbox-alignment").remove(),_.find(".lightbox-alignment2").remove(),_.find("img").remove()},Y=function(){_.find("iframe").remove()},R=function(){_.find(".lb-loader").remove()},J=function(){_.append('<div class="lb-loader"/>')};_.attr("unselectable","on").css("user-select","none").on("selectstart",!1);var K=function(){P.stop(!0,!0).width(0)},Z=function(){clearInterval(A.interval)},U=function(){0!=n.lightBoxShowTimer&&P.css({position:"absolute",bottom:0}).animate({width:"100%"},n.lightBoxPlayInterval,"linear",function(){K()})},X=!1,V=!1,tt=function(){A.interval=setTimeout(function(){lt()},n.lightBoxPlayInterval),U()},it=function(){X&&0==V&&(K(),Z(),tt())},et=function(t){var e=i('<iframe src="'+t+'" class="lightbox-iframe" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>');_.append(e.hide());var o=e[0];o.attachEvent?o.attachEvent("onload",function(){R(),e.fadeIn(n.lightBoxSpeedFx,function(){it()}),N(),G=new Image}):o.onload=function(){R(),e.fadeIn(n.lightBoxSpeedFx,function(){it()}),N(),G=new Image}},ot=i("<span />"),st=function(t,o){Y(),H(),R(),J();var s=0,r=0;1!=o&&(s=.9,r=n.lightBoxSpeedFx),0==n.lightBoxZoomAnim&&(s=1);var a=t,l=a.data("lightbox");l==e&&(l=a.attr("src"));var h=a.siblings("div.lightbox-text").html();0==n.lightBoxText&&(h="");var c="<div><div>"+h+"</div></div>";F.html(c);var u=a.siblings("div.lightbox-img-title").html(),f="";for(var g in n.videos)if(l==d+"/"+g){f=n.videos[g];break}if(""!=f)return void et(f);G=new Image;var m=i(G),p=G;G.onload=function(){if(p==G){R();var t=i('<div class="lightbox-alignment"></div>').appendTo(_),e=i('<div class="lightbox-alignment2"></div>').appendTo(t);e.append(m.css("margin-top",-z.outerHeight(!1)).hide().scale(s)),m.fadeIn(r).animate({scale:"1"},{duration:n.lightBoxSpeedFx,complete:function(){it()}}),N()}},G.src=l,G.alt=u,G.title=u,ot.stop(!0),ot=i(G)},nt=!1,rt="";r.on("click","div.gbox",function(){nt=!0;var o=i(this),s=o.data("url");if(rt="",s!=e&&1==n.linkOnLightbox)rt="http://"+s;else if(s!=e)return void(t.location.href="http://"+s);if(0!=n.lightBox){V=!1,W=r.find(".gbox").index(this);var a=o.children("img");z.animate({"margin-top":0},n.lightBoxSpeedFx),_.fadeIn(n.lightBoxSpeedFx),st(a,!0)}}),_.on("click","div",function(t){t.stopPropagation()}),_.on("click","img",function(t){t.stopPropagation()}),_.on("click",".lightbox-alignment",function(){at()}),_.on("click",".lightbox-alignment2",function(){at()}),_.on("click",function(){at()}),M.on("click",function(){at()});var at=function(){Y(),n.lightBoxStopPlayOnClose&&($.removeClass("selected"),X=!1),nt=!1,V=!0,K(),Z(),_.find(".lb-loader").remove();var t=0;0==n.lightBoxZoomAnim&&(t=1);var i=_.find("img").stop().show();z.animate({"margin-top":-z.outerHeight(!1)},n.lightBoxSpeedFx),i[0]!=e?i.animate({scale:t},n.lightBoxSpeedFx,function(){_.fadeOut(100)}):_.fadeOut(100)},lt=function(){V=!1;var t=r.find(".gbox");if(W+=1,W>=t.length&&(W=0),!t.eq(W).is(":visible"))for(var i=W,o=0;o<t.length;o++)if(i++,i>=t.length&&(i=0),t.eq(i).is(":visible")){W=i;break}var s=t.eq(W).children("img"),a=t.eq(W).data("url");rt="",a!=e&&1==n.linkOnLightbox&&(rt="http://"+a),st(s)},ht=function(){V=!1;var t=r.find(".gbox");if(W-=1,0>W&&(W=t.length-1),!t.eq(W).is(":visible"))for(var i=W,o=0;o<t.length;o++)if(i--,0>i&&(i=t.length-1),t.eq(i).is(":visible")){W=i;break}var s=t.eq(W).children("img"),a=t.eq(W).data("url");rt="",a!=e&&1==n.linkOnLightbox&&(rt="http://"+a),st(s)};j.on("click",function(){K(),Z(),lt()}),_.on("click","img",function(){""==rt?(K(),Z(),lt()):location.href=rt}),q.on("click",function(){K(),Z(),ht()}),i(document).keyup(function(t){if(n.lightboxKeyboardNav){if("37"==t.keyCode){if(0==nt)return;K(),Z(),ht()}if("39"==t.keyCode){if(0==nt)return;K(),Z(),lt()}27==t.keyCode&&at()}}),n.lightBoxAutoPlay&&($.addClass("selected"),X=!0),$.on("click",function(){s=i(this),s.hasClass("selected")?(s.removeClass("selected"),X=!1,K(),Z()):(s.addClass("selected"),X=!0,tt())})};if("string"==typeof o){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var t=i.data(this,"grid");return t?i.isFunction(t[o])&&"_"!==o.charAt(0)?void t[o].apply(t,n):void logError("no such method '"+o+"' for grid instance"):void logError("cannot call methods on grid prior to initialization; attempted to call method '"+o+"'")})}else this.each(function(){var t=i.data(this,"grid");t?(t.option(o||{}),t._init()):(s(this),i.data(this,"grid",new i.Mason(o,this)))});return this},i.fn.grid.defaults={categoriesOrder:"byName",imagesOrder:"byDate",orderInAll:!1,isFitWidth:!0,lazyLoad:!0,showNavBar:!0,smartNavBar:!0,imagesToLoadStart:15,imagesToLoad:5,aleatoryImagesFromCategories:!0,horizontalSpaceBetweenThumbnails:5,verticalSpaceBetweenThumbnails:5,columnWidth:"auto",columns:5,columnMinWidth:220,isAnimated:!0,caption:!0,captionCategory:!0,captionType:"grid",lightBox:!0,lightboxKeyboardNav:!0,lightBoxSpeedFx:500,lightBoxZoomAnim:!0,lightBoxText:!0,lightboxPlayBtn:!0,lightBoxAutoPlay:!1,lightBoxPlayInterval:4e3,lightBoxShowTimer:!0,lightBoxStopPlayOnClose:!1,videos:{},linkOnLightbox:!1,hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},visibleCaption:!1}}(window,jQuery);


